{"version":3,"sources":["../index.js"],"names":["restify","require","botbuilder","server","createServer","listen","process","env","port","PORT","console","log","name","url","connector","ChatConnector","appId","APP_ID","appPassword","APP_SECRET","post","bot","UniversalBot","session","send","message","text","card","AnimationCard","title","subtitle","image","CardImage","create","media","msg","Message","addAttachment","on","membersAdded","length","map","x","isSelf","id","address","join"],"mappings":";;AAAA,IAAIA,UAAUC,QAAQ,SAAR,CAAd;AACA,IAAIC,aAAaD,QAAQ,YAAR,CAAjB;;AAEA;AACA,IAAIE,SAASH,QAAQI,YAAR,EAAb;AACAD,OAAOE,MAAP,CAAcC,QAAQC,GAAR,CAAYC,IAAZ,IAAoBF,QAAQC,GAAR,CAAYE,IAAhC,IAAwC,IAAtD,EAA4D,YAAY;AACpEC,YAAQC,GAAR,CAAY,sBAAZ,EAAoCR,OAAOS,IAA3C,EAAiDT,OAAOU,GAAxD;AACH,CAFD;;AAIA;AACA,IAAIC,YAAY,IAAIZ,WAAWa,aAAf,CAA6B;AACzCC,WAAOV,QAAQC,GAAR,CAAYU,MADsB;AAEzCC,iBAAaZ,QAAQC,GAAR,CAAYY;AAFgB,CAA7B,CAAhB;;AAKA;AACAhB,OAAOiB,IAAP,CAAY,eAAZ,EAA6BN,UAAUT,MAAV,EAA7B;;AAEA;AACA,IAAIgB,MAAM,IAAInB,WAAWoB,YAAf,CAA4BR,SAA5B,EAAuC,UAAUS,OAAV,EAAmB;AAChEA,YAAQC,IAAR,CAAa,kBAAb,EAAiCD,QAAQE,OAAR,CAAgBC,IAAjD;AACA;AACA,QAAIC,OAAO,IAAIzB,WAAW0B,aAAf,CAA6BL,OAA7B,EACNM,KADM,CACA,MADA,EAENC,QAFM,CAEG,WAFH,EAGNC,KAHM,CAGA7B,WAAW8B,SAAX,CAAqBC,MAArB,CAA4BV,OAA5B,EAAqC,uDAArC,CAHA,EAINW,KAJM,CAIA,CACH,EAAErB,KAAK,uDAAP,EADG,CAJA,CAAX;AAOA,QAAIsB,MAAM,IAAIjC,WAAWkC,OAAf,CAAuBb,OAAvB,EAAgCc,aAAhC,CAA8CV,IAA9C,CAAV;AACAJ,YAAQC,IAAR,CAAaW,GAAb;;AAEAd,QAAIiB,EAAJ,CAAO,QAAP,EAAiB,YAAM;AACnBf,gBAAQC,IAAR,CAAa,WAAb;AACH,KAFD;;AAIAH,QAAIiB,EAAJ,CAAO,oBAAP,EAA6B,UAAUb,OAAV,EAAmB;;AAE5C,YAAIA,QAAQc,YAAR,IAAwBd,QAAQc,YAAR,CAAqBC,MAArB,GAA8B,CAA1D,EAA6D;;AAEzD,gBAAID,eAAed,QAAQc,YAAR,CAAqBE,GAArB,CAAyB,UAAUC,CAAV,EAAa;AACrD,oBAAIC,SAASD,EAAEE,EAAF,IAAQnB,QAAQoB,OAAR,CAAgBxB,GAAhB,CAAoBuB,EAAzC;AACA,uBAAO,CAACD,SAASlB,QAAQoB,OAAR,CAAgBxB,GAAhB,CAAoBT,IAA7B,GAAoC8B,EAAE9B,IAAvC,KAAgD,MAAM,MAAN,GAAe8B,EAAEE,EAAjB,GAAsB,IAA7E;AACH,aAHkB,EAGhBE,IAHgB,CAGX,IAHW,CAAnB;;AAMAzB,gBAAIG,IAAJ,CAAS,IAAItB,WAAWkC,OAAf,GACJS,OADI,CACIpB,QAAQoB,OADZ,EAEJnB,IAFI,CAEC,eAAea,YAFhB,CAAT;AAGH;AACJ,KAdD;AAgBH,CAjCS,CAAV","file":"index.js","sourcesContent":["let restify = require('restify')\nlet botbuilder = require('botbuilder')\n\n// setup the restify server\nlet server = restify.createServer()\nserver.listen(process.env.port || process.env.PORT || 3987, function () {\n    console.log('%s bot started at %s', server.name, server.url);\n})\n\n// create chat connector\nlet connector = new botbuilder.ChatConnector({\n    appId: process.env.APP_ID,\n    appPassword: process.env.APP_SECRET\n})\n\n// Listening for user inputs\nserver.post('/api/messages', connector.listen())\n\n// Reply by echoing\nlet bot = new botbuilder.UniversalBot(connector, function (session) {\n    session.send('Reprends Ã§a: %s ', session.message.text)\n    //session.send(JSON.stringify(session.dialogData))\n    let card = new botbuilder.AnimationCard(session)\n        .title('Card')\n        .subtitle('Well done')\n        .image(botbuilder.CardImage.create(session, 'https://media.giphy.com/media/xDQ3Oql1BN54c/giphy.gif'))\n        .media([\n            { url: 'https://media.giphy.com/media/xDQ3Oql1BN54c/giphy.gif' }\n        ]);\n    let msg = new botbuilder.Message(session).addAttachment(card);\n    session.send(msg);\n\n    bot.on('typing', () => {\n        session.send('Ca vient?');\n    })\n\n    bot.on('conversationUpdate', function (message) {\n\n        if (message.membersAdded && message.membersAdded.length > 0) {\n\n            let membersAdded = message.membersAdded.map(function (x) {\n                let isSelf = x.id == message.address.bot.id;\n                return (isSelf ? message.address.bot.name : x.name) || ' ' + '(Id=' + x.id + ' )'\n            }).join(', ');\n\n\n            bot.send(new botbuilder.Message()\n                .address(message.address)\n                .text('Bienvenue ' + membersAdded));\n        }\n    });\n\n});"]}